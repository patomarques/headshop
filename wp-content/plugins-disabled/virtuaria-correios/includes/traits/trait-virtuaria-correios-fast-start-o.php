<?php
 defined("\101\102\x53\x50\x41\x54\x48") || die; trait Virtuaria_Correios_Fast_Start_Functions { public function make_fast_start() { if (isset($_POST["\156\157\156\143\145"], $_POST["\x63\145\x70"]) && wp_verify_nonce(sanitize_text_field(wp_unslash($_POST["\156\157\156\x63\x65"])), "\x64\x6f\55\x66\x61\x73\x74\x2d\x73\164\141\x72\x74")) { try { foreach (WC_Shipping_Zones::get_zones() as $zone) { $current_zone = WC_Shipping_Zones::get_zone($zone["\172\157\156\x65\137\151\144"]); if ($current_zone) { $current_zone->set_zone_order($current_zone->get_zone_order() + 1); $current_zone->save(); } } $zone = new WC_Shipping_Zone(); $zone->set_zone_name("\102\x72\141\x73\151\154"); $zone->set_locations(array(array("\143\157\144\145" => "\102\x52", "\164\171\x70\x65" => "\x63\x6f\165\156\164\162\171"))); $zone->set_zone_order(0); $zone->save(); $methods = array(); $methods["\x43\x6f\162\x72\145\151\x6f\x73\40\x53\x65\144\x65\x78"] = $zone->add_shipping_method("\166\151\x72\x74\165\141\162\151\141\55\143\x6f\162\162\145\x69\157\x73\x2d\x73\x65\x64\x65\170"); $methods["\103\x6f\162\162\145\x69\157\163\40\x50\x61\143"] = $zone->add_shipping_method("\x76\151\162\x74\165\141\x72\151\x61\x2d\x63\x6f\162\162\145\x69\x6f\x73\55\163\x65\x64\145\x78"); if (isset($_POST["\157\x70\164\151\157\156\x61\154\137\x73\x65\x72\166\x69\143\145\x73"])) { $services = array_map("\163\x61\x6e\x69\164\151\x7a\x65\x5f\164\x65\170\164\137\x66\151\145\x6c\x64", wp_unslash($_POST["\157\160\x74\x69\x6f\156\x61\x6c\137\x73\145\x72\166\x69\143\x65\x73"])); } $cep = sanitize_text_field(wp_unslash($_POST["\x63\x65\x70"])); foreach ($methods as $key => $instance_id) { if (0 !== $instance_id) { $method = \WC_Shipping_Zones::get_shipping_method($instance_id); $method->instance_settings["\x74\151\x74\154\145"] = $key; $method->instance_settings["\157\x72\151\x67\x69\156"] = $cep; if ("\103\x6f\162\x72\145\x69\x6f\x73\x20\123\x65\x64\145\x78" === $key) { $method->instance_settings["\x73\145\x72\166\x69\143\x65\x5f\x63\x6f\144"] = "\60\63\x32\62\x30"; } else { $method->instance_settings["\x73\x65\162\x76\x69\x63\145\x5f\143\157\144"] = "\x30\63\62\71\70"; } if ($services) { foreach ($services as $service) { switch ($service) { case "\x61\x72": $method->instance_settings["\x72\x65\x63\145\151\160\164\x5f\x6e\157\164\151\x63\145"] = "\x79\145\x73"; break; case "\x69\156\x73\x75\x72\x61\156\x63\145\55\x73\x74\x61\x74\x65\x6d\x65\156\x74": $method->instance_settings["\x6d\x69\156\137\166\x61\154\x75\145\x5f\144\x65\143\154\141\162\145\144"] = 27; if ("\103\x6f\162\162\145\x69\x6f\163\40\x53\145\x64\145\x78" === $key) { $method->instance_settings["\x64\x65\143\x6c\141\x72\x65\x5f\166\x61\x6c\165\145"] = "\60\61\71"; } else { $method->instance_settings["\144\x65\x63\x6c\141\162\145\137\166\141\154\165\x65"] = "\60\x36\x34"; } break; case "\157\167\156\55\x68\x61\156\x64\x73": $method->instance_settings["\157\167\156\137\150\x61\x6e\x64\x73"] = "\171\145\163"; break; } } } update_option($method->get_instance_option_key(), $method->instance_settings); } } $settings = Virtuaria_WPMU_Correios_Settings::get_settings(); if (!isset($settings["\165\x73\145\x72\156\141\x6d\145"], $settings["\160\x61\x73\x73\x77\157\162\x64"], $settings["\x70\157\163\164\137\143\x61\x72\x64"]) || empty($settings["\x75\163\145\162\156\x61\155\x65"]) || empty($settings["\x70\x61\x73\163\x77\x6f\162\x64"]) || empty($settings["\160\x6f\163\164\137\x63\x61\x72\x64"])) { $settings["\x65\x61\x73\x79\137\x6d\157\x64\x65"] = "\171\x65\x73"; $setup = new Virtuaria_WPMU_Correios_Settings(); $setup->setup_virtuaria_settings($settings); } echo "\x73\x75\x63\x63\x65\x73\163"; } catch (\Exception $e) { wc_get_logger()->add("\x76\x69\162\x74\x75\141\x72\151\141\x2d\143\157\x72\x72\145\x69\x6f\163", "\106\x61\x6c\150\x61\x20\x61\x6f\40\143\x72\x69\x61\162\x20\x6d\303\xa9\164\x6f\x64\157\40\144\x65\x20\160\x61\147\x61\x6d\x65\156\x74\x6f\x3a\40" . $e->getMessage(), WC_Log_Levels::ERROR); $zone->delete_shipping_method($instance_id); } } wp_die(); } }